package fr.unice.polytech.si3.qgl.royal_fortune.tooling.simulation;

import fr.unice.polytech.si3.qgl.royal_fortune.environment.SeaEntities;
import fr.unice.polytech.si3.qgl.royal_fortune.environment.Wind;

import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

public class Main {

	static final Logger logger = Logger.getLogger(Main.class.getName());
	public static void main(String[] args) throws IOException {
		String json= "{\"goal\":{\"mode\":\"REGATTA\",\"checkpoints\":[{\"position\":{\"x\":1000,\"y\":100,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":100.0}},{\"position\":{\"x\":-200.0,\"y\":1000.0,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":80.0}}]},\"ship\":{\"type\":\"ship\",\"position\":{\"x\":0.0,\"y\":0.0,\"orientation\":0.0},\"name\":\"royal_fortune\",\"deck\":{\"width\":2,\"length\":4},\"entities\":[{\"x\":1,\"y\":0,\"type\":\"oar\"},{\"x\":1,\"y\":1,\"type\":\"oar\"},{\"x\":2,\"y\":0,\"type\":\"oar\"},{\"x\":2,\"y\":1,\"type\":\"oar\"},{\"x\":3,\"y\":0,\"type\":\"oar\"},{\"x\":3,\"y\":1,\"type\":\"oar\"}],\"life\":300,\"shape\":{\"type\":\"rectangle\",\"width\":2.0,\"height\":4.0,\"orientation\":0.0}},\"sailors\":[{\"x\":0,\"y\":0,\"id\":0,\"name\":\"Jack Teach\"},{\"x\":0,\"y\":1,\"id\":1,\"name\":\"Jack Teach\"},{\"x\":1,\"y\":0,\"id\":2,\"name\":\"Jack Pouce\"},{\"x\":1,\"y\":1,\"id\":3,\"name\":\"Luffy Pouce\"}],\"shipCount\":1}";
		String jsonTest = "{\"goal\":{\"mode\":\"REGATTA\",\"checkpoints\":[{\"position\":{\"x\":1000,\"y\":100,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":100}},{\"position\":{\"x\":-200,\"y\":1000,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":80}}]},\"ship\":{\"type\":\"ship\",\"position\":{\"x\":0,\"y\":0,\"orientation\":0},\"name\":\"royal_fortune\",\"deck\":{\"width\":4,\"length\":3},\"entities\":[{\"x\":1,\"y\":0,\"type\":\"oar\"},{\"x\":1,\"y\":1,\"type\":\"oar\"},{\"x\":2,\"y\":0,\"type\":\"oar\"},{\"x\":2,\"y\":1,\"type\":\"oar\"},{\"x\":3,\"y\":0,\"type\":\"oar\"},{\"x\":3,\"y\":1,\"type\":\"rudder\"},{\"x\":3,\"y\":2,\"type\":\"sail\"},{\"x\":3,\"y\":1,\"type\":\"oar\"}],\"life\":300,\"shape\":{\"type\":\"rectangle\",\"width\":2,\"height\":4,\"orientation\":0}},\"sailors\":[{\"x\":0,\"y\":0,\"id\":0,\"name\":\"Jack Teach\"},{\"x\":0,\"y\":1,\"id\":1,\"name\":\"Jack Teach\"},{\"x\":1,\"y\":0,\"id\":2,\"name\":\"Jack Pouce\"},{\"x\":1,\"y\":1,\"id\":3,\"name\":\"Luffy Pouce\"},{\"x\":1,\"y\":3,\"id\":4,\"name\":\"Luffy olala\"},{\"x\":1,\"y\":2,\"id\":5,\"name\":\"Luffy siuuuu\"}],\"shipCount\":1}";
		String jsonWeek5 = "{\"goal\":{\"mode\":\"REGATTA\",\"checkpoints\":[{\"position\":{\"x\":-5586.701434159062,\"y\":-195.31249999999972,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-3259.452411994781,\"y\":1835.937500000001,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-1401.564537157755,\"y\":4108.072916666667,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-3650.5867014341584,\"y\":1529.9479166666674,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-5495.436766623214,\"y\":4127.604166666669,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-1140.8083441981753,\"y\":-273.43749999999847,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":-3604.9543676662297,\"y\":2154.9479166666674,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}},{\"position\":{\"x\":3337.6792698826616,\"y\":1809.8958333333335,\"orientation\":0},\"shape\":{\"type\":\"circle\",\"radius\":200}}]},\"ship\":{\"type\":\"ship\",\"position\":{\"x\":-3650.58670143416,\"y\":1842.4479166666663,\"orientation\":-2.740166925631097},\"name\":\"royal_fortune\",\"deck\":{\"width\":3,\"length\":7},\"entities\":[{\"x\":6,\"y\":1,\"type\":\"rudder\"},{\"x\":3,\"y\":1,\"type\":\"sail\",\"openned\":false},{\"x\":1,\"y\":2,\"type\":\"oar\"},{\"x\":2,\"y\":2,\"type\":\"oar\"},{\"x\":3,\"y\":2,\"type\":\"oar\"},{\"x\":4,\"y\":2,\"type\":\"oar\"},{\"x\":5,\"y\":2,\"type\":\"oar\"},{\"x\":1,\"y\":0,\"type\":\"oar\"},{\"x\":2,\"y\":0,\"type\":\"oar\"},{\"x\":3,\"y\":0,\"type\":\"oar\"},{\"x\":4,\"y\":0,\"type\":\"oar\"},{\"x\":5,\"y\":0,\"type\":\"oar\"}],\"life\":1050,\"shape\":{\"type\":\"rectangle\",\"width\":3,\"height\":7,\"orientation\":0}},\"sailors\":[{\"x\":0,\"y\":0,\"id\":0,\"name\":\"Edward Pouce\"},{\"x\":0,\"y\":1,\"id\":1,\"name\":\"Jack Teach\"},{\"x\":0,\"y\":2,\"id\":2,\"name\":\"Edward Pouce\"},{\"x\":1,\"y\":0,\"id\":3,\"name\":\"Edward Teach\"},{\"x\":1,\"y\":1,\"id\":4,\"name\":\"Luffy Pouce\"},{\"x\":1,\"y\":2,\"id\":5,\"name\":\"Luffy Pouce\"},{\"x\":2,\"y\":0,\"id\":6,\"name\":\"Edward Pouce\"},{\"x\":2,\"y\":1,\"id\":7,\"name\":\"Edward Pouce\"},{\"x\":2,\"y\":2,\"id\":8,\"name\":\"Luffy Teach\"},{\"x\":3,\"y\":0,\"id\":9,\"name\":\"Jack Teach\"},{\"x\":3,\"y\":1,\"id\":10,\"name\":\"Jack Teach\"},{\"x\":3,\"y\":2,\"id\":11,\"name\":\"Luffy Teach\"}],\"seaEntities\":[{\"position\":{\"x\":8153.389030097254,\"y\":351.1753941441404,\"orientation\":0.4537856055185257},\"type\":\"reef\",\"shape\":{\"type\":\"rectangle\",\"width\":\"400\",\"height\":\"1350\"}},{\"type\":\"stream\",\"position\":{\"x\":500,\"y\":0,\"orientation\":0},\"shape\":{\"type\":\"rectangle\",\"width\":50,\"height\":500,\"orientation\":0},\"strength\":40}],\"shipCount\":1}";
		String jsonWeek6 = "{\"goal\":{\"mode\":\"REGATTA\",\"checkpoints\":[{\"position\":{\"x\":8182.608695652171,\"y\":2654.7231270358307,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":200.0}},{\"position\":{\"x\":5469.565217391305,\"y\":-1123.7785016286687,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":1500.0}},{\"position\":{\"x\":4434.7826086956475,\"y\":374.5928338762211,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":200.0}},{\"position\":{\"x\":1939.1304347826083,\"y\":5806.188925081433,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":200.0}},{\"position\":{\"x\":9573.913043478302,\"y\":5765.472312703588,\"orientation\":0.0},\"shape\":{\"type\":\"circle\",\"radius\":200.0}}]},\"ship\":{\"type\":\"ship\",\"position\":{\"x\":2652.1739130434785,\"y\":2646.5798045602605,\"orientation\":0.0},\"name\":\"royal_fortune\",\"deck\":{\"width\":3,\"length\":8},\"entities\":[{\"x\":1,\"y\":1,\"type\":\"rudder\"},{\"x\":6,\"y\":0,\"type\":\"oar\"},{\"x\":6,\"y\":2,\"type\":\"oar\"},{\"x\":5,\"y\":2,\"type\":\"oar\"},{\"x\":4,\"y\":2,\"type\":\"oar\"},{\"x\":3,\"y\":2,\"type\":\"oar\"},{\"x\":3,\"y\":0,\"type\":\"oar\"},{\"x\":4,\"y\":0,\"type\":\"oar\"},{\"x\":5,\"y\":0,\"type\":\"oar\"},{\"x\":6,\"y\":1,\"type\":\"sail\",\"openned\":false},{\"x\":7,\"y\":2,\"type\":\"oar\"},{\"x\":7,\"y\":0,\"type\":\"oar\"}],\"life\":1200,\"shape\":{\"type\":\"rectangle\",\"width\":3.0,\"height\":8.0,\"orientation\":0.0}},\"sailors\":[{\"x\":0,\"y\":0,\"id\":0,\"name\":\"Luffy Teach\"},{\"x\":0,\"y\":1,\"id\":1,\"name\":\"Luffy Pouce\"},{\"x\":0,\"y\":2,\"id\":2,\"name\":\"Jack Teach\"},{\"x\":1,\"y\":0,\"id\":3,\"name\":\"Luffy Teach\"},{\"x\":1,\"y\":1,\"id\":4,\"name\":\"Jack Pouce\"},{\"x\":1,\"y\":2,\"id\":5,\"name\":\"Tom Pouce\"},{\"x\":2,\"y\":0,\"id\":6,\"name\":\"Edward Pouce\"},{\"x\":2,\"y\":1,\"id\":7,\"name\":\"Edward Pouce\"},{\"x\":2,\"y\":2,\"id\":8,\"name\":\"Edward Pouce\"},{\"x\":3,\"y\":0,\"id\":9,\"name\":\"Jack Pouce\"},{\"x\":3,\"y\":1,\"id\":10,\"name\":\"Jack Pouce\"},{\"x\":3,\"y\":2,\"id\":11,\"name\":\"Edward Pouce\"}],\"shipCount\":1}";
		String jsonWeek6Nig = "{\"goal\":{\"mode\":\"REGATTA\",\"checkpoints\":[{\"type\":\"checkpoint\",\"position\":{\"x\":4036.4115963579497,\"y\":264.956362612613},\"shape\":{\"type\":\"circle\",\"radius\":100}},{\"type\":\"checkpoint\",\"position\":{\"x\":6866.105430167673,\"y\":277.9420045045067},\"shape\":{\"type\":\"circle\",\"radius\":100}},{\"type\":\"checkpoint\",\"position\":{\"x\":8019.417976524843,\"y\":1210.6559684684694},\"shape\":{\"type\":\"circle\",\"radius\":100}},{\"type\":\"checkpoint\",\"position\":{\"x\":8100.5085279370105,\"y\":2245.8826013513526},\"shape\":{\"type\":\"circle\",\"radius\":100}},{\"type\":\"checkpoint\",\"position\":{\"x\":4652.274679791037,\"y\":2802.9983108108113},\"shape\":{\"type\":\"circle\",\"radius\":100}}]},\"ship\":{\"name\":\"Licorne\",\"deck\":{\"length\":7,\"width\":3},\"entities\":[{\"type\":\"rudder\",\"x\":6,\"y\":1},{\"type\":\"sail\",\"x\":3,\"y\":1},{\"type\":\"oar\",\"x\":1,\"y\":2},{\"type\":\"oar\",\"x\":2,\"y\":2},{\"type\":\"oar\",\"x\":3,\"y\":2},{\"type\":\"oar\",\"x\":5,\"y\":2},{\"type\":\"oar\",\"x\":4,\"y\":2},{\"type\":\"oar\",\"x\":1,\"y\":0},{\"type\":\"oar\",\"x\":2,\"y\":0},{\"type\":\"oar\",\"x\":4,\"y\":0},{\"type\":\"oar\",\"x\":3,\"y\":0},{\"type\":\"oar\",\"x\":5,\"y\":0}],\"life\":1050},\"wind\":{\"orientation\":0,\"strength\":50},\"seaEntities\":[{\"position\":{\"x\":8153.389030097254,\"y\":351.1753941441404,\"orientation\":0.4537856055185257},\"type\":\"reef\",\"shape\":{\"type\":\"rectangle\",\"width\":\"400\",\"height\":\"1350\"}},{\"position\":{\"x\":6186.903137789905,\"y\":2006.7567567567567,\"orientation\":-0.17453292519943295},\"type\":\"reef\",\"shape\":{\"type\":\"rectangle\",\"width\":500,\"height\":\"1750\"}},{\"position\":{\"x\":6630.286493860851,\"y\":3209.4594594594596,\"orientation\":-0.24434609527920614},\"type\":\"reef\",\"shape\":{\"type\":\"rectangle\",\"width\":500,\"height\":\"1750\"}},{\"position\":{\"x\":7174.22818123444,\"y\":1102.9701576576585,\"orientation\":0.6981317007977318},\"type\":\"reef\",\"shape\":{\"type\":\"rectangle\",\"width\":\"250\",\"height\":\"1200\"}},{\"position\":{\"x\":7409.664698840839,\"y\":701.646959459459,\"orientation\":0.7330382858376184},\"type\":\"stream\",\"shape\":{\"type\":\"rectangle\",\"width\":\"400\",\"height\":\"1000\"},\"strength\":10},{\"position\":{\"x\":6384.720327421553,\"y\":2581.0810810810804,\"orientation\":3.0019663134302466},\"type\":\"stream\",\"shape\":{\"type\":\"rectangle\",\"width\":200,\"height\":1000},\"strength\":10}],\"maxRound\":500,\"minumumCrewSize\":12,\"maximumCrewSize\":12,\"startingPositions\":[{\"x\":2852.173913043478,\"y\":1978.827361563518,\"orientation\":-1.0297442586766543}]}";
		//------------------
		Wind wind = new Wind(0.0, 10.0);
		List<SeaEntities> visibleEntities = new ArrayList<>();
		//------------------

		Game game = new Game(jsonWeek6Nig);
		StringBuilder textForOutput = new StringBuilder(game.getAllCheckpointsForOutput() + "---\n");
		int tour=0;
		while (!game.isFinished()) {
			game.nextRound(wind);
			logger.info(String.valueOf(game));
			textForOutput.append(game);
			tour++;
		}

		try (BufferedWriter writer = new BufferedWriter(new FileWriter("output.txt"))) {
			try {
				writer.write(String.valueOf(textForOutput));
			} catch (IOException e) {
				// TODO Auto-generated catch block
				logger.log(Level.INFO, "Exception");
			}
		}

	}
}
